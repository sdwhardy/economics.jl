
############################ Reads Data from Excel ########################
################################################################################
#**
function get_Cost_Data()
    ks=cost_ks()
    ks.ldc=0.5175# changed from 1.775 on 8/12/21 to reflect cost in ENTSO-e
    ks.lac=0.5175# changed from 0.32 on 3/12/21 to reflect cost in ENTSO-e
    ks.opx_c=0.025#OPEX percent
    ks.E_op=100.0#Euro/MWh (used in losses)
    return ks
end

#ABB XLPE Submarine Cable Systems Attachment to XLPE Land Cable Systems not subsea - User´s Guide Table:49
#500: 0.14microF/km 0.43mH/km
#630: 0.16microF/km 0.41mH/km
#800: 0.17microF/km 0.40mH/km
#1000: 0.19microF/km 0.38mH/km
#Capacity: table 34
#400: 590
#500: 655
#630: 715
#800: 775
#1000: 825
#resistances:
#500: 0.0490ohms/km
#630: 0.0391ohms/km
#800: 0.0323ohms/km
#1000: 0.0273ohms/km
#costs: Centre for Sustainable Electricity and Distributed Generation
#500: 515*1.16(gbp/euro)
#630: 550
#800: 675
#1000: 700
#***Data for 1600 is taken from FEM simulation while cost is linear interpolation
function get_220kV_cables()#[kv, mm, mOhms/km, picoF/km, Amps, kE/km, mH/km]
    cbls220=[[220.0, 400.0, 40.1, 122.0, 590.0, 496.48, 0.457], [220.0, 500.0, 49.0, 140.0, 655.0, 597.4, 0.43], [220.0, 630.0, 39.1, 160.0, 715.0, 638.0, 0.41], [220.0, 800.0, 32.3, 170.0, 775.0, 783.0, 0.4], [220.0, 1000.0, 27.3, 190.0, 825.0, 812.0, 0.38], [220.0, 1600.0, 17.9, 190.0, 950.0, 1162.0, 0.35]]
    return cbls220
end

#**#[kv, mm, mOhms/km, picoF/km, Amps, kE/km, mH/km]
function get_500kV_cables()
    cbls500=[[500, 500, 46.7, 0.7, 1072, 510, 0.7], [500, 630, 36.1, 0.7, 1246, 516.5, 0.7], [500, 800, 28.2, 0.7, 1438, 525, 0.7], [500, 1000, 22.4, 0.7, 1644, 535, 0.7], [500, 1200, 19.3, 0.7, 1791, 545, 0.7], [500, 1400, 16.4, 0.7, 1962, 555, 0.7], [500, 1500, 15.4, 0.7, 2042.5, 560, 0.7], [500, 1600, 14.4, 0.7, 2123, 565, 0.7], [500, 1800, 12.9, 0.7, 2265, 575, 0.7], [500, 2000, 11.5, 0.7, 2407, 604, 0.7], [500, 2200, 10.3, 0.7, 2540, 633, 0.7], [500, 2400, 9.6, 0.7, 2678, 662, 0.7], [500, 2500, 9.2, 0.7, 2746, 719, 0.7], [500, 2600, 8.7, 0.7, 2814, 776, 0.7], [500, 2800, 7.8, 0.7, 2937, 890, 0.7], [500, 3000, 6.9, 0.7, 3066, 1004, 0.7]]
    return cbls500
end

#NOTE 66 and 132 kV cables are guess afrom interpolations or sizes in:
#https://www.sab-cable.com/cables-wires-harnessing-temperature-measurement/technical-data/cables-and-wires/american-cable-stranding.html
function get_66kV_cables()
    #keys=["mOhms/km", "nanoF/km", "Amps", "kE/km", "mH/km"]
    #cbls66=Dict()                                                                                                                                                                                                                                                                                             
    #for c in [[66.0, 95.0, 170.0, 170, 300.0, 187.92, 0.44], [66.0, 120.0, 140.0, 180, 340.0, 199.52, 0.43], [66.0, 150.0, 110.0, 190, 375.0, 211.12, 0.41], [66.0, 185.0, 90.0, 200.0, 420.0, 227.36, 0.4], [66.0, 240.0, 70.0, 220.0, 480.0, 251.72, 0.38], [66.0, 300.0, 50.0, 240.0, 530.0, 274.92, 0.37], [66.0, 400.0, 40.0, 260.0, 590.0, 306.24, 0.35], [66.0, 500.0, 30.0, 290.0, 655.0, 345.68, 0.34], [66.0, 630.0, 27.1, 320.0, 715.0, 387.44, 0.33], [66.0, 800.0, 22.5, 350.0, 775.0, 436.16, 0.32], [66.0, 1000.0, 19.8, 380.0, 825.0, 482.56, 0.31]]
    #    push!(cbls66,string(c[2])=>Dict(zip(keys,c[3:end])))
    #end
    #cbls66=[[66.0, 95.0, 170.0, 170, 300.0, 187.92, 0.44], [66.0, 120.0, 140.0, 180, 340.0, 199.52, 0.43], [66.0, 150.0, 110.0, 190, 375.0, 211.12, 0.41], [66.0, 185.0, 90.0, 200.0, 420.0, 227.36, 0.4], [66.0, 240.0, 70.0, 220.0, 480.0, 251.72, 0.38], [66.0, 300.0, 50.0, 240.0, 530.0, 274.92, 0.37], [66.0, 400.0, 40.0, 260.0, 590.0, 306.24, 0.35], [66.0, 500.0, 30.0, 290.0, 655.0, 345.68, 0.34], [66.0, 630.0, 27.1, 320.0, 715.0, 387.44, 0.33], [66.0, 800.0, 22.5, 350.0, 775.0, 436.16, 0.32], [66.0, 1000.0, 19.8, 380.0, 825.0, 482.56, 0.31]]
    #cbls66=[[66,8.35,1705.12312996323,142.034795,75,170.02888,0.638251514509792],[66,13.29,1092.93993738137,143.209033,95,171.672912,0.594443472762768],[66,21.14,700.945470960344,145.074978,120,174.285392,0.553692731427477],[66,26.65,561.587547748593,146.384705,154,176.11912,0.534414472928312],[66,33.61,449.758454846978,148.039097,170,178.435408,0.515774898606373],[66,42.38,360.260519756682,150.123726,180,181.354064,0.497799274186585],[66,95,170,170,300,187.92,0.44],[66,120,140,180,340,199.52,0.43],[66,150,110,190,375,211.12,0.41],[66,185,90,200,420,227.36,0.4],[66,240,70,220,480,251.72,0.38],[66,300,50,240,530,274.92,0.37],[66,400,40,260,590,306.24,0.35],[66,500,30,290,655,345.68,0.34],[66,630,27.1,320,715,387.44,0.33],[66,800,22.5,350,775,436.16,0.32],[66,1000,19.8,380,825,482.56,0.31]]
    cbls66=[[66,240,70,220,480,251.72,0.38],[66,300,50,240,530,274.92,0.37],[66,400,40,260,590,306.24,0.35],[66,500,30,290,655,345.68,0.34],[66,630,27.1,320,715,387.44,0.33],[66,800,22.5,350,775,436.16,0.32],[66,1000,19.8,380,825,482.56,0.31], [66.0, 1200.0, 15.1, 304.0, 1081, 615, 0.55], [66.0, 1600.0, 11.3, 338.0, 1227, 670, 0.52]]

    return cbls66
end

#Entso-E
#MVA Voltage Cost 
#200 132 kV 518 – 805 
function get_132kV_cables()
    #keys=["mOhms/km", "nanoF/km", "Amps", "kE/km", "mH/km"]
    #cbls132=Dict()
    #for c in  [[132.0, 300.0, 78.1, 144.0, 468, 313.44, 0.43], [132.0, 400.0, 61.8, 164.0, 523, 401.36, 0.41], [132.0, 500.0, 49.2, 185.0, 581, 471.54, 0.38], [132.0, 630.0, 39.3, 212.0, 642, 512.72, 0.36], [132.0, 800.0, 32.6, 235.0, 702, 609.58, 0.35], [132.0, 1000.0, 17.6, 289.0, 1007, 647.28, 0.56], [132.0, 1200.0, 15.1, 304.0, 1081, 680, 0.55], [132.0, 1600.0, 11.3, 338.0, 1227, 740, 0.52]]
    #    push!(cbls132,string(c[2])=>Dict(zip(keys,c[3:end])))
    #end
    #cbls132=[[132.0, 300.0, 78.1, 144.0, 468, 313.44, 0.43], [132.0, 400.0, 61.8, 164.0, 523, 401.36, 0.41], [132.0, 500.0, 49.2, 185.0, 581, 471.54, 0.38], [132.0, 630.0, 39.3, 212.0, 642, 512.72, 0.36], [132.0, 800.0, 32.6, 235.0, 702, 609.58, 0.35], [132.0, 1000.0, 17.6, 289.0, 1007, 647.28, 0.56], [132.0, 1200.0, 15.1, 304.0, 1081, 680, 0.55], [132.0, 1600.0, 11.3, 338.0, 1227, 740, 0.52]]
    #cbls132=[[132,8.35,1705.12312996323,142.034795,75,193.523779781818,0.638251514509792],[132,13.29,1092.93993738137,143.209033,95,195.394987112727,0.594443472762768],[132,21.14,700.945470960344,145.074978,120,198.368464349091,0.553692731427477],[132,26.65,561.587547748593,146.384705,154,200.455580218182,0.534414472928312],[132,33.61,449.758454846978,148.039097,170,203.091937105455,0.515774898606373],[132,42.38,360.260519756682,150.123726,180,206.413898298182,0.497799274186585],[132,95,170,170,300,213.887127272727,0.44],[132,120,140,180,340,227.090036363636,0.43],[132,150,110,190,375,240.292945454545,0.41],[132,185,90,200,420,258.777018181818,0.4],[132,240,70,220,480,286.503127272727,0.38],[132,300,50,240,530,312.908945454545,0.37],[132,400,40,260,590,348.5568,0.35],[132,500,30,290,655,393.446690909091,0.34],[132,630,27.1,320,715,440.977163636364,0.33],[132,800,22.5,350,775,496.429381818182,0.32],[132,1000,19.8,380,825,549.241018181818,0.31], [132.0, 1200.0, 15.1, 304.0, 1081, 680, 0.55], [132.0, 1600.0, 11.3, 338.0, 1227, 740, 0.52]]
    cbls132=[[132,185,90,200,420,258.777018181818,0.4],[132,240,70,220,480,286.503127272727,0.38],[132,300,50,240,530,312.908945454545,0.37],[132,400,40,260,590,348.5568,0.35],[132,500,30,290,655,393.446690909091,0.34],[132,630,27.1,320,715,440.977163636364,0.33],[132,800,22.5,350,775,496.429381818182,0.32],[132,1000,19.8,380,825,549.241018181818,0.31], [132.0, 1200.0, 15.1, 304.0, 1081, 680, 0.55], [132.0, 1600.0, 11.3, 338.0, 1227, 740, 0.52]]

    return cbls132
end

#checks
#Entso-E
#MVA Voltage Cost 
#300 220 kV 575 – 863  for 100km (3core): 80.5-184.05 (mean 132.275) result: capex 157.255 (includes 12.465 in reactive compensation)
#Catapult
#1GW 60km 227 (assuming 1/3 of listed cable installation costs) Result: capex 235.882 (including compensation)
#=function get_220kV_cables()
    keys=["mOhms/km", "nanoF/km", "Amps", "kE/km", "mH/km"]
    cbls220=Dict()
    for c in [[220.0, 400.0, 40.1, 122.0, 590.0, 496.48, 0.457], [220.0, 500.0, 49.0, 140.0, 655.0, 597.4, 0.43], [220.0, 630.0, 39.1, 160.0, 715.0, 638.0, 0.41], [220.0, 800.0, 32.3, 170.0, 775.0, 783.0, 0.4], [220.0, 1000.0, 27.3, 180.0, 825.0, 812.0, 0.38], [220.0, 1600.0, 17.9, 190.0, 950.0, 1162.0, 0.35]]
        push!(cbls220,string(c[2])=>Dict(zip(keys,c[3:end])))
    end
    return cbls220
end=#


#**
#NOTE 1.5 in price accounts for 3 seperate laying of cables.
function get_400kV_cables()
    #keys=["mOhms/km", "nanoF/km", "Amps", "kE/km", "mH/km"]
    #cbls400=Dict()
    #for c in [[400.0, 630.0, 28.3, 119.0, 594.0, 1.5*916.4, 0.46], [400.0, 800.0, 22.1, 134.0, 636.0, 1.5*997.6, 0.44], [400.0, 1000.0, 17.6, 150.0, 671.0, 1.5*1154.2, 0.41], [400.0, 1600.0, 15.6, 188.0, 779.0, 1.5*1624.0, 0.52], [400.0, 2000.0, 12.9, 209.0, 840.0, 1.5*1780.6, 0.50], [400.0, 2500.0, 10.9, 226.0, 893.0, 1.5*2000, 0.47]]
    #    push!(cbls400,string(c[2])=>Dict(zip(keys,c[3:end])))
    #end
    cbls400=[[400.0, 630.0, 28.3, 119.0, 594.0, 1.5*916.4, 0.46], [400.0, 800.0, 22.1, 134.0, 636.0, 1.5*997.6, 0.44], [400.0, 1000.0, 17.6, 150.0, 671.0, 1.5*1154.2, 0.41], [400.0, 1600.0, 15.6, 188.0, 779.0, 1.5*1624.0, 0.52], [400.0, 2000.0, 12.9, 209.0, 840.0, 1.5*1780.6, 0.50], [400.0, 2500.0, 10.9, 226.0, 893.0, 1.5*2000, 0.47]]
    return cbls400
end


###########################################################
######################### cables ##########################
###########################################################
#original data is in excel file but reading file and can access directly or to put in a struct togther use with get_Cable_Data_from_file()

#400/630:
#approx. µF/km 0,119
#220/630
#approx. µF/km 0,155
#132/630
#approx. µF/km 0,177
#**
#=function get_220kV_cables()
    cbls220=[[220.0, 400.0, 40.1, 122.0, 665.0, 496.48, 0.457], [220.0, 500.0, 30.0, 136.0, 732.0, 597.4, 0.437], [220.0, 630.0, 27.1, 151.0, 808.0, 638.0, 0.415], [220.0, 800.0, 22.5, 163.0, 879.0, 783.0, 0.4], [220.0, 1000.0, 19.8, 177.0, 942.0, 812.0, 0.386]]
    #cbls220=[[220.0, 400.0, 60.1, 122.0, 10000, 10000000, 0.457]]
    return cbls220
end=#


#entso-e
#materials
#150/320kV not checked yet
#Cross-sectional Euro/m
#Area (mm2) 150 kV 320 kV 
#1200 230 – 460 345 – 518 
#1500 288 – 460 345 – 518 
#1800 345 – 518 345 – 575 
#2000 345 – 575 403 – 660 
#installation: 230 – 977.5Euros/route-metre
#**
function get_150kV_cables()
    keys=["mOhms/km", "nanoF/km", "Amps", "kE/km", "mH/km"]
    cbls150=Dict()
    for c in [[150.0, 1000.0, 22.4, 0.7, 1644.0, 179.8, 0.7], [150.0, 1200.0, 19.2, 0.7, 1791.0, 208.8, 0.7], [150.0, 1400.0, 16.5, 0.7, 1962.0, 234.9, 0.7], [150.0, 1600.0, 14.4, 0.7, 2123.0, 261.0, 0.7], [150.0, 2000.0, 11.5, 0.7, 2407.0, 290.0, 0.7]]
        push!(cbls150,string(c[2])=>Dict(zip(keys,c[3:end])))
    end
    return cbls150
end

#**
function get_300kV_cables()
    keys=["mOhms/km", "nanoF/km", "Amps", "kE/km", "mH/km"]
    cbls300=Dict()
    for c in [[300.0, 1000.0, 22.4, 0.7, 1644.0, 263.9, 0.7], [300.0, 1200.0, 19.2, 0.7, 1791.0, 295.8, 0.7], [300.0, 1400.0, 16.5, 0.7, 1962.0, 333.5, 0.7], [300.0, 1600.0, 14.4, 0.7, 2123.0, 371.2, 0.7], [300.0, 2000.0, 11.5, 0.7, 2407.0, 411.8, 0.7]]
        push!(cbls300,string(c[2])=>Dict(zip(keys,c[3:end])))
    end
    return cbls300
end

#ENTSO-E values
#Cross-sectional 
#Area (mm2) 500 kV 
#1500 460 – 660 for 100km (2core): 138-327.5 (mean 232.75) result: capex 224
#1800 460 – 690 for 100km (2core): 138-333.5 result: capex 230
#2000 460 – 748 for 100km (2core): 138-345.1 result: capex 241.6
#2500 575 – 863 for 100km (2core): 161-368.1 (mean: 264.55) result: capex 287.6
#installation: 230 – 977.5Euros/route-metre
#**#[kv, mm, mOhms/km, nanoF/km, Amps, E/m, mH/km]
#=function get_500kV_cables()
    keys=["mOhms/km", "nanoF/km", "Amps", "kE/km", "mH/km"]
    cbls500=Dict()
    for c in [[500, 95, 170.0, 0.7, 404, 277.2, 0.7],[500, 120, 140.0, 0.7, 387, 294.4, 0.7],[500, 150, 110.0, 0.7, 463, 311.5, 0.7],[500, 185, 90.0, 0.7, 496, 335.4, 0.7], [500, 240, 70.0, 0.7, 580, 371.4, 0.7],[500, 300, 50.0, 0.7, 662, 405.6, 0.7], [500, 500, 46.7, 0.7, 1072, 510, 0.7], [500, 630, 36.1, 0.7, 1246, 516.5, 0.7], [500, 800, 28.2, 0.7, 1438, 525, 0.7], [500, 1000, 22.4, 0.7, 1644, 535, 0.7], [500, 1200, 19.3, 0.7, 1791, 545, 0.7], [500, 1400, 16.4, 0.7, 1962, 555, 0.7], [500, 1500, 15.4, 0.7, 2042.5, 560, 0.7], [500, 1600, 14.4, 0.7, 2123, 565, 0.7], [500, 1800, 12.9, 0.7, 2265, 575, 0.7], [500, 2000, 11.5, 0.7, 2407, 604, 0.7], [500, 2200, 10.3, 0.7, 2540, 633, 0.7], [500, 2400, 9.6, 0.7, 2678, 662, 0.7], [500, 2500, 9.2, 0.7, 2746, 719, 0.7], [500, 2600, 8.7, 0.7, 2814, 776, 0.7], [500, 2800, 7.8, 0.7, 2937, 890, 0.7], [500, 3000, 6.9, 0.7, 3066, 1004, 0.7]]
        push!(cbls500,string(c[2])=>Dict(zip(keys,c[3:end])))
    end
    return cbls500
end=#


